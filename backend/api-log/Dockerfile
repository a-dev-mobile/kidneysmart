# Используем официальный базовый образ Go версии 1.22.2
FROM golang:1.22.2

# Устанавливаем рабочий каталог внутри контейнера
WORKDIR /app

# Копируем файлы go.mod и go.sum в рабочую директорию
COPY go.mod go.sum ./

# Загружаем зависимости проекта, это ускорит последующие сборки
RUN go mod download

# Копируем все остальные файлы проекта в рабочую директорию
COPY . .

# Переходим в каталог, где находится основной исполняемый файл
WORKDIR /app/cmd

# Собираем приложение, результатом будет файл main
RUN go build -o main .

# Открываем порт для внешних подключений
EXPOSE 8001

# Запускаем приложение
CMD ["./main"]
